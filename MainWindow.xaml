<!-- MainWindow.xaml
     NewPCSetupWPF â€” Premium dark UI v3.
     Layout: left sidebar (theme, profiles, actions, execution log)
     + right content (catalog with horizontal category tabs).
     All colors use DynamicResource. No hard-coded hex values. -->
<Window x:Class="NewPCSetupWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
        xmlns:c="clr-namespace:NewPCSetupWPF.Converters"
        mc:Ignorable="d"
        Title="Initio"
        Width="1440"
        Height="940"
        MinWidth="1200"
        MinHeight="780"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResize"
        Background="Transparent"
        Icon="pack://application:,,,/Images/app_icon.png"
        Loaded="Window_Loaded">
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome CaptionHeight="0"
                            CornerRadius="0"
                            GlassFrameThickness="0"
                            ResizeBorderThickness="8"
                            UseAeroCaptionButtons="False" />
    </shell:WindowChrome.WindowChrome>

    <Window.Resources>
        <!-- â•â•â• Converters â•â•â• -->
        <c:InverseBoolConverter x:Key="InverseBoolConverter" />
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        
        <!-- â•â•â• Card container â•â•â• -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="16" />
        </Style>

        <!-- â•â•â• Section title â•â•â• -->
        <Style x:Key="SectionTitleStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
        </Style>

        <!-- â•â•â• Section description â•â•â• -->
        <Style x:Key="SectionDescriptionStyle" TargetType="TextBlock">
            <Setter Property="Margin" Value="0,3,0,0" />
            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="FontSize" Value="12" />
        </Style>

        <!-- â•â•â• Sidebar section label â•â•â• -->
        <Style x:Key="SidebarLabelStyle" TargetType="TextBlock">
            <Setter Property="Margin" Value="4,0,0,8" />
            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="10" />
        </Style>

        <!-- â•â•â• Primary button template â•â•â• -->
        <Style x:Key="ModernButtonBase" TargetType="Button">
            <Setter Property="Height" Value="32" />
            <Setter Property="Padding" Value="14,6" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="FontSize" Value="12" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Foreground" Value="#FFFFFF" />
            <Setter Property="Background" Value="{DynamicResource AccentBrush}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="BtnRoot"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                SnapsToDevicePixels="True"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              RecognizesAccessKey="True" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="BtnRoot" Property="Background" Value="{DynamicResource AccentHoverBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="BtnRoot" Property="Background" Value="{DynamicResource AccentPressedBrush}" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="BtnRoot" Property="Opacity" Value="0.3" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style TargetType="Button" BasedOn="{StaticResource ModernButtonBase}" />

        <!-- â•â•â• Ghost (secondary) button â•â•â• -->
        <Style x:Key="GhostButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonBase}">
            <Setter Property="Background" Value="{DynamicResource SurfaceHighBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="GhostRoot"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="8"
                                SnapsToDevicePixels="True"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              RecognizesAccessKey="True" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="GhostRoot" Property="Background" Value="{DynamicResource OverlayBrush}" />
                                <Setter TargetName="GhostRoot" Property="BorderBrush" Value="{DynamicResource BorderLightBrush}" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="GhostRoot" Property="Background" Value="{DynamicResource SurfaceBrush}" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="GhostRoot" Property="Opacity" Value="0.3" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• Danger button â•â•â• -->
        <Style x:Key="DangerButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonBase}">
            <Setter Property="Background" Value="{DynamicResource DangerBrush}" />
            <Setter Property="Foreground" Value="#FFFFFF" />
        </Style>

        <!-- â•â•â• Search Box Style â•â•â• -->
        <Style x:Key="SearchBoxStyle" TargetType="TextBox">
            <Setter Property="Height" Value="32" />
            <Setter Property="Padding" Value="10,0" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="Background" Value="{DynamicResource InputBgBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="16"
                                SnapsToDevicePixels="True">
                            <ScrollViewer x:Name="PART_ContentHost" Focusable="false"
                                          HorizontalScrollBarVisibility="Hidden"
                                          VerticalScrollBarVisibility="Hidden"
                                          Margin="10,0" /> <!-- Added internal margin for text -->
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="true">
                                <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource AccentSecondaryBrush}"/>
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource SurfaceHighBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• Profile pill â•â•â• -->
        <Style x:Key="ProfilePillStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonBase}">
            <Setter Property="Height" Value="28" />
            <Setter Property="Padding" Value="12,4" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="FontWeight" Value="Medium" />
            <Setter Property="Background" Value="{DynamicResource SurfaceHighBrush}" />
            <Setter Property="Foreground" Value="{DynamicResource TextSecondaryBrush}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="PillRoot"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="14"
                                SnapsToDevicePixels="True"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="PillRoot" Property="Background" Value="{DynamicResource OverlayBrush}" />
                                <Setter TargetName="PillRoot" Property="BorderBrush" Value="{DynamicResource AccentBrush}" />
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Active profile pill -->
        <Style x:Key="ProfilePillActiveStyle" TargetType="Button" BasedOn="{StaticResource ProfilePillStyle}">
            <Setter Property="Background" Value="{DynamicResource AccentBrush}" />
            <Setter Property="Foreground" Value="#FFFFFF" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{DynamicResource AccentBrush}"
                                BorderBrush="{DynamicResource AccentBrush}"
                                BorderThickness="1"
                                CornerRadius="14"
                                SnapsToDevicePixels="True"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• Category tab pill â•â•â• -->
        <Style x:Key="CategoryTabStyle" TargetType="Button" BasedOn="{StaticResource ProfilePillStyle}">
            <Setter Property="Height" Value="26" />
            <Setter Property="Padding" Value="10,4" />
            <Setter Property="FontSize" Value="11" />
        </Style>
        <Style x:Key="CategoryTabActiveStyle" TargetType="Button" BasedOn="{StaticResource ProfilePillActiveStyle}">
            <Setter Property="Height" Value="26" />
            <Setter Property="Padding" Value="10,4" />
            <Setter Property="FontSize" Value="11" />
        </Style>

        <!-- â•â•â• Caption buttons â•â•â• -->
        <Style x:Key="CaptionButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="46" />
            <Setter Property="Height" Value="36" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
            <Setter Property="FontFamily" Value="Segoe MDL2 Assets" />
            <Setter Property="FontSize" Value="10" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="CRoot" Background="Transparent" SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="CRoot" Property="Background" Value="{DynamicResource SurfaceHighBrush}" />
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CloseCaptionButtonStyle" TargetType="Button" BasedOn="{StaticResource CaptionButtonStyle}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="ClRoot" Background="Transparent" SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ClRoot" Property="Background" Value="#C42B1C" />
                                <Setter Property="Foreground" Value="White" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• TextBox â•â•â• -->
        <Style TargetType="TextBox">
            <Setter Property="Height" Value="32" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="Background" Value="{DynamicResource InputBgBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Padding" Value="10,5" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="CaretBrush" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="TBB"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="0" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter TargetName="TBB" Property="BorderBrush" Value="{DynamicResource AccentBrush}" />
                            </Trigger>
                            <Trigger Property="IsReadOnly" Value="True">
                                <Setter TargetName="TBB" Property="Background" Value="Transparent" />
                                <Setter TargetName="TBB" Property="BorderBrush" Value="Transparent" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• ComboBox â•â•â• -->
        <ControlTemplate x:Key="ComboBoxToggleButton" TargetType="ToggleButton">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="28" />
                </Grid.ColumnDefinitions>
                <Border x:Name="CBBorder"
                        Grid.ColumnSpan="2"
                        Background="{DynamicResource InputBgBrush}"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="8" />
                <Path Grid.Column="1"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      Data="M0,0 L4,4 L8,0"
                      Fill="{DynamicResource TextMutedBrush}"
                      Stroke="{DynamicResource TextMutedBrush}"
                      StrokeThickness="1" />
            </Grid>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter TargetName="CBBorder" Property="BorderBrush" Value="{DynamicResource BorderLightBrush}" />
                </Trigger>
                <Trigger Property="IsChecked" Value="True">
                    <Setter TargetName="CBBorder" Property="BorderBrush" Value="{DynamicResource AccentBrush}" />
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>

        <Style TargetType="ComboBox">
            <Setter Property="Height" Value="32" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="Background" Value="{DynamicResource InputBgBrush}" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton Template="{StaticResource ComboBoxToggleButton}"
                                          IsChecked="{Binding Path=IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          Focusable="False" ClickMode="Press" />
                            <ContentPresenter IsHitTestVisible="False"
                                              Content="{TemplateBinding SelectionBoxItem}"
                                              ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                              ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}"
                                              Margin="10,0,28,0"
                                              VerticalAlignment="Center"
                                              HorizontalAlignment="Left">
                                <ContentPresenter.Resources>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
                                    </Style>
                                </ContentPresenter.Resources>
                            </ContentPresenter>
                            <Popup Placement="Bottom"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   PopupAnimation="Slide">
                                <Grid MinWidth="{TemplateBinding ActualWidth}"
                                      MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <Border Background="{DynamicResource SurfaceBrush}"
                                            BorderBrush="{DynamicResource BorderBrush}"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Margin="0,2,0,0"
                                            Padding="4">
                                        <ScrollViewer>
                                            <StackPanel IsItemsHost="True"
                                                        KeyboardNavigation.DirectionalNavigation="Contained" />
                                        </ScrollViewer>
                                    </Border>
                                </Grid>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ComboBoxItem">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Padding" Value="10,6" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border x:Name="CIBorder" Background="Transparent" CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter TargetName="CIBorder" Property="Background" Value="{DynamicResource SurfaceHighBrush}" />
                                <Setter Property="Foreground" Value="{DynamicResource AccentSecondaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="CIBorder" Property="Background" Value="{DynamicResource AccentBrush}" />
                                <Setter Property="Foreground" Value="#FFFFFF" />
                                <Setter Property="FontWeight" Value="Bold" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• TabControl â€” visible header strip â•â•â• -->
        <Style x:Key="TabControlStyle" TargetType="TabControl">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>
                            <!-- Tab header strip with bottom border -->
                            <Border Grid.Row="0"
                                    Background="{DynamicResource SurfaceBrush}"
                                    BorderBrush="{DynamicResource BorderBrush}"
                                    BorderThickness="0,0,0,1"
                                    Padding="8,0">
                                <TabPanel IsItemsHost="True"
                                          HorizontalAlignment="Left"
                                          Margin="0" />
                            </Border>
                            <!-- Tab content -->
                            <ContentPresenter Grid.Row="1"
                                              ContentSource="SelectedContent" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="FontSize" Value="13" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
            <Setter Property="Padding" Value="18,10" />
            <Setter Property="Margin" Value="0,0,2,0" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="TabRoot"
                                Background="Transparent"
                                BorderThickness="0,0,0,3"
                                BorderBrush="Transparent"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="6,6,0,0"
                                SnapsToDevicePixels="True">
                            <ContentPresenter x:Name="TabText"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"
                                              ContentSource="Header"
                                              RecognizesAccessKey="True" />
                        </Border>
                        <ControlTemplate.Triggers>
                             <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="TabRoot" Property="Background" Value="{DynamicResource OverlayBrush}" />
                                <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="TabRoot" Property="BorderBrush" Value="{DynamicResource AccentBrush}" />
                                <Setter TargetName="TabRoot" Property="Background" Value="{DynamicResource AccentBrush}" />
                                <!-- Removed Opacity=0.2 on root which faded text. Using semi-transparent background if needed, but accent is usually solid. 
                                     If Accent is too strong, use a specific opacity brush or SurfaceHigh. 
                                     Let's use SurfaceHigh with a strong bottom border for the "Selected" look, to keep text readable. -->
                                <Setter TargetName="TabRoot" Property="Background" Value="{DynamicResource SurfaceHighBrush}" />
                                <Setter Property="Foreground" Value="{DynamicResource AccentSecondaryBrush}" />
                                <Setter Property="FontWeight" Value="Bold" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• ScrollBar (thin, modern) â•â•â• -->
        <Style x:Key="SBPageBtnStyle" TargetType="RepeatButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RepeatButton">
                        <Border Background="Transparent" />
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SBThumbStyle" TargetType="Thumb">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Thumb">
                        <Border x:Name="TH"
                                Background="{DynamicResource BorderLightBrush}"
                                CornerRadius="3"
                                Margin="1" />
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="TH" Property="Background" Value="{DynamicResource TextMutedBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ScrollBar">
            <Setter Property="SnapsToDevicePixels" Value="True" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid Background="Transparent">
                            <Track x:Name="PART_Track" Margin="1" IsDirectionReversed="True">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton x:Name="DB" Style="{StaticResource SBPageBtnStyle}" Command="ScrollBar.PageUpCommand" />
                                </Track.DecreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Style="{StaticResource SBThumbStyle}" />
                                </Track.Thumb>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton x:Name="IB" Style="{StaticResource SBPageBtnStyle}" Command="ScrollBar.PageDownCommand" />
                                </Track.IncreaseRepeatButton>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="Orientation" Value="Horizontal">
                                <Setter Property="Height" Value="6" />
                                <Setter TargetName="DB" Property="Command" Value="ScrollBar.PageLeftCommand" />
                                <Setter TargetName="IB" Property="Command" Value="ScrollBar.PageRightCommand" />
                                <Setter TargetName="PART_Track" Property="IsDirectionReversed" Value="False" />
                            </Trigger>
                            <Trigger Property="Orientation" Value="Vertical">
                                <Setter Property="Width" Value="6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• ListView â•â•â• -->
        <Style TargetType="ListView">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
        </Style>

        <!-- ListViewItem â€” row hover per-item, no focus rectangle, no left bar -->
        <Style TargetType="ListViewItem">
            <Setter Property="Padding" Value="6,8" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListViewItem">
                        <Border x:Name="ItemBg"
                                Background="Transparent"
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="6"
                                Margin="0,1"
                                BorderThickness="0">
                            <GridViewRowPresenter VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ItemBg" Property="Background" Value="{DynamicResource SurfaceHighBrush}" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="ItemBg" Property="Background" Value="{DynamicResource OverlayBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="GridViewColumnHeader">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="0,0,0,1" />
            <Setter Property="Padding" Value="10,8" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="11" />
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="GridViewColumnHeader">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• ProgressBar â•â•â• -->
        <Style TargetType="ProgressBar">
            <Setter Property="Height" Value="6" />
            <Setter Property="Background" Value="{DynamicResource SurfaceHighBrush}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ProgressBar">
                        <Grid>
                            <Border x:Name="PART_Track" Background="{TemplateBinding Background}" CornerRadius="3" />
                            <Border x:Name="PART_Indicator" HorizontalAlignment="Left" CornerRadius="3"
                                    Background="{DynamicResource AccentGradientBrush}" />
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â•â•â• CheckBox (High Contrast) â•â•â• -->
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderLightBrush}" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Border x:Name="box" Width="18" Height="18" CornerRadius="4"
                                    BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1"
                                    Background="{TemplateBinding Background}" Margin="0,0,8,0">
                                <!-- High-contrast cyan/green checkmark -->
                                <Path x:Name="check" Data="M3,9 L7,13 L15,5" 
                                      Stroke="#00FF9D" StrokeThickness="2" Visibility="Collapsed" />
                            </Border>
                            <ContentPresenter VerticalAlignment="Center" />
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="check" Property="Visibility" Value="Visible" />
                                <Setter TargetName="box" Property="BorderBrush" Value="#00FF9D" />
                                <Setter TargetName="box" Property="Background" Value="#1000FF9D" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="box" Property="BorderBrush" Value="{DynamicResource TextPrimaryBrush}" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <!-- â•â•â• Window Shell â€” rounded, no extra black border â•â•â• -->
    <Border Background="{DynamicResource BackgroundBrush}"
            CornerRadius="10">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="36" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- â•â•â• TITLE BAR â•â•â• -->
            <Border Grid.Row="0"
                    Background="{DynamicResource HeaderBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="0,0,0,1"
                    CornerRadius="10,10,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="16,0,0,0">
                        <Ellipse Width="7" Height="7" Fill="{DynamicResource AccentBrush}" Margin="0,0,10,0" />
                        <TextBlock FontSize="12" FontWeight="Bold"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   FontFamily="{DynamicResource AppFont}"
                                   Text="New PC Setup" />
                        <TextBlock Margin="10,0,0,0" FontSize="11"
                                   Foreground="{DynamicResource TextMutedBrush}"
                                   VerticalAlignment="Center"
                                   Text="winget bootstrap" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal"
                                shell:WindowChrome.IsHitTestVisibleInChrome="True">
                        <Button Style="{StaticResource CaptionButtonStyle}" Content="&#xE921;" Click="WindowMinimize_Click" />
                        <Button Style="{StaticResource CaptionButtonStyle}" Content="&#xE922;" Click="WindowMaxRestore_Click" />
                        <Button Style="{StaticResource CloseCaptionButtonStyle}" Content="&#xE8BB;" Click="WindowClose_Click" />
                    </StackPanel>
                </Grid>
            </Border>

            <!-- â•â•â• MAIN CONTENT â•â•â• -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="240" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- â•â•â• LEFT SIDEBAR â•â•â• -->
                <Border Grid.Column="0"
                        Background="{DynamicResource SidebarBrush}"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="0,0,1,0"
                        CornerRadius="0,0,0,10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <ScrollViewer Grid.Row="0"
                                      VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled"
                                      Margin="14,14,14,0">
                            <StackPanel>
                                <!-- THEME -->
                                <TextBlock Style="{StaticResource SidebarLabelStyle}" Text="THEME" />
                                <ComboBox ItemsSource="{Binding ThemeOptions}"
                                          SelectedItem="{Binding SelectedTheme, Mode=TwoWay}"
                                          Margin="0,0,0,16">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding DisplayName}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>

                                <!-- QUICK PROFILES -->
                                <TextBlock Style="{StaticResource SidebarLabelStyle}" Text="QUICK PROFILES" />
                                <WrapPanel Margin="0,0,0,16">
                                    <Button x:Name="ProfileDefault" Content="â­ Default" Style="{StaticResource ProfilePillStyle}" Click="ProfileDefault_Click" Margin="0,0,5,5" />
                                    <Button x:Name="ProfileDev" Content="ðŸ’» Dev" Style="{StaticResource ProfilePillStyle}" Click="ProfileDev_Click" Margin="0,0,5,5" />
                                    <Button x:Name="ProfileHomeOffice" Content="ðŸ  Office" Style="{StaticResource ProfilePillStyle}" Click="ProfileHomeOffice_Click" Margin="0,0,5,5" />
                                    <Button x:Name="ProfileGaming" Content="ðŸŽ® Gaming" Style="{StaticResource ProfilePillStyle}" Click="ProfileGaming_Click" Margin="0,0,5,5" />
                                    <Button x:Name="ProfileCustom" Content="âš™ Custom" Style="{StaticResource ProfilePillStyle}" Click="ProfileCustom_Click" Margin="0,0,5,5" />
                                </WrapPanel>

                                <!-- CATALOG ACTIONS -->
                                <TextBlock Style="{StaticResource SidebarLabelStyle}" Text="CATALOG ACTIONS" />
                                <Button Content="Remove Selected"
                                        Style="{StaticResource GhostButtonStyle}"
                                        Click="RemoveSelectedApp_Click"
                                        IsEnabled="{Binding CanRemoveSelectedApp}"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,5" />
                                <Button Content="Reset Defaults"
                                        Style="{StaticResource GhostButtonStyle}"
                                        Click="ResetDefaultCatalog_Click"
                                        IsEnabled="{Binding CanEditCatalog}"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,0,0,16" />

                                <!-- EXECUTION LOG (top-aligned, scrollable) -->
                                <TextBlock Style="{StaticResource SidebarLabelStyle}" Text="EXECUTION LOG" />
                                <Border Background="{DynamicResource InputBgBrush}"
                                        BorderBrush="{DynamicResource BorderBrush}"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="8,6"
                                        MinHeight="180"
                                        MaxHeight="400">
                                    <TextBox x:Name="LogTextBox"
                                             IsReadOnly="True"
                                             AcceptsReturn="True"
                                             TextWrapping="Wrap"
                                             VerticalScrollBarVisibility="Auto"
                                             HorizontalScrollBarVisibility="Disabled"
                                             FontFamily="{DynamicResource MonoFont}"
                                             FontSize="10.5"
                                             Text="{Binding LogText}"
                                             Background="Transparent"
                                             BorderThickness="0"
                                             Padding="0"
                                             Height="Auto"
                                             VerticalAlignment="Top"
                                             VerticalContentAlignment="Top" />
                                </Border>
                                
                                <!-- SIMULATION MODE REMOVED -->
                                <CheckBox Content="Silent Install" 
                                          IsChecked="{Binding IsSilentInstall}"
                                          Style="{StaticResource GlobalCheckBoxStyle}"
                                          Margin="0,0,0,0" 
                                          ToolTip="Uncheck this to run installers interactively (allows you to uncheck data collection options)."/>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- Sidebar footer: status + progress -->
                        <Border Grid.Row="1"
                                Background="{DynamicResource SurfaceBrush}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="0,1,0,0"
                                CornerRadius="0,0,0,10"
                                Padding="14,10">
                            <StackPanel>
                                <TextBlock FontSize="10" FontWeight="Bold"
                                           Foreground="{DynamicResource TextMutedBrush}" Text="STATUS" />
                                <TextBlock Margin="0,4,0,0" FontSize="11" FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           Text="{Binding StatusText}"
                                           TextTrimming="CharacterEllipsis" />
                                <TextBlock Margin="0,2,0,0" FontSize="10"
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           Text="{Binding EtaText}" />
                                <ProgressBar Margin="0,6,0,0"
                                             Minimum="0" Maximum="{Binding ProgressMaximum}" Value="{Binding ProgressValue}" />
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!-- â•â•â• RIGHT CONTENT AREA â•â•â• -->
                <Grid Grid.Column="1" Margin="16,12,16,12">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <!-- Header row: title + action buttons -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <StackPanel>
                            <TextBlock Style="{StaticResource SectionTitleStyle}" Text="Package Catalog" />
                            <TextBlock Style="{StaticResource SectionDescriptionStyle}"
                                       Text="Select apps to install. Use profiles for quick presets, or browse the store for more." />
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Top">
                            <Button Content="Install Selected" Click="InstallSelected_Click" IsEnabled="{Binding CanInstall}" Margin="0,0,5,0" />
                            <Button Content="Cancel" Style="{StaticResource DangerButtonStyle}" Click="CancelInstall_Click" IsEnabled="{Binding CanCancelInstall}" />
                        </StackPanel>
                    </Grid>

                    <!-- Refresh + summary bar -->
                    <Grid Grid.Row="1" Margin="0,10,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <Button Content="Refresh Installed" Style="{StaticResource GhostButtonStyle}"
                                Click="RefreshInstalled_Click" IsEnabled="{Binding CanInstall}" />
                        <Border Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Center"
                                Background="{DynamicResource SurfaceHighBrush}"
                                CornerRadius="8" Padding="12,5">
                            <TextBlock Text="{Binding SelectionSummary}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="11" />
                        </Border>
                    </Grid>

                    <!-- Tab area: catalog tabs -->
                    <Border Grid.Row="2" Margin="0,10,0,0" Style="{StaticResource CardStyle}" Padding="0">
                        <TabControl x:Name="MainTabControl" Style="{StaticResource TabControlStyle}" SelectedIndex="0">
                            <!-- â•â•â• TAB 1: My Setup â€” selected + installed apps â•â•â• -->
                            <TabItem x:Name="CatalogTab" Header="ðŸ“¦  My Setup">
                                <Border Padding="12,8">
                                    <ListView ItemsSource="{Binding AppItemsView}"
                                              SelectionMode="Single"
                                              SelectedItem="{Binding SelectedAppItem, Mode=TwoWay}"
                                              VirtualizingPanel.IsVirtualizing="True"
                                              VirtualizingPanel.ScrollUnit="Pixel">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Width="42" Header="âœ“">
                                                    <GridViewColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <CheckBox HorizontalAlignment="Center"
                                                                      Style="{StaticResource GlobalCheckBoxStyle}"
                                                                      IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                                      IsHitTestVisible="True">

                                                            </CheckBox>
                                                        </DataTemplate>
                                                    </GridViewColumn.CellTemplate>
                                                </GridViewColumn>
                                                <GridViewColumn Width="180" Header="Name" DisplayMemberBinding="{Binding Name}" />
                                                <GridViewColumn Width="100" Header="Category" DisplayMemberBinding="{Binding Category}" />
                                                <GridViewColumn Width="240" Header="Winget ID" DisplayMemberBinding="{Binding WingetId}" />
                                                <GridViewColumn Width="100" Header="Status">
                                                    <GridViewColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding InstallStatus}">
                                                                <TextBlock.Style>
                                                                    <Style TargetType="TextBlock">
                                                                        <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                                                <Setter Property="Foreground" Value="{DynamicResource SuccessBrush}" />
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBlock.Style>
                                                            </TextBlock>
                                                        </DataTemplate>
                                                    </GridViewColumn.CellTemplate>
                                                </GridViewColumn>
                                                <GridViewColumn Width="80" Header="Installed">
                                                    <GridViewColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Ellipse Width="7" Height="7" Margin="0,0,5,0">
                                                                    <Ellipse.Style>
                                                                        <Style TargetType="Ellipse">
                                                                            <Setter Property="Fill" Value="{DynamicResource BorderBrush}" />
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                                                    <Setter Property="Fill" Value="{DynamicResource SuccessBrush}" />
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Ellipse.Style>
                                                                </Ellipse>
                                                                <TextBlock>
                                                                    <TextBlock.Style>
                                                                        <Style TargetType="TextBlock">
                                                                            <Setter Property="Text" Value="No" />
                                                                            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding IsInstalled}" Value="True">
                                                                                    <Setter Property="Text" Value="Yes" />
                                                                                    <Setter Property="Foreground" Value="{DynamicResource SuccessBrush}" />
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </TextBlock.Style>
                                                                </TextBlock>
                                                            </StackPanel>
                                                        </DataTemplate>
                                                    </GridViewColumn.CellTemplate>
                                                </GridViewColumn>
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </Border>
                            </TabItem>

                            <!-- â•â•â• TAB 2: Store by Category â•â•â• -->
                            <TabItem Header="ðŸª  Store by Category">
                                <Border Padding="12,8">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!-- Category tabs (horizontal pills) -->
                                        <WrapPanel x:Name="CategoryTabsPanel" Grid.Row="0" Margin="0,4,0,0" />

                                        <!-- Search -->
                                        <Grid Grid.Row="1" Margin="0,8,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="280" />
                                            </Grid.ColumnDefinitions>
                                            <TextBox Text="{Binding StoreTrendQuery, UpdateSourceTrigger=PropertyChanged}" />
                                        </Grid>

                                        <!-- Store list -->
                                        <ListView x:Name="StoreListView" Grid.Row="2" Margin="0,8,0,0"
                                                  ItemsSource="{Binding StoreTrendItemsView}"
                                                  SelectionMode="Single"
                                                  SelectedItem="{Binding SelectedStoreTrendItem, Mode=TwoWay}"
                                                  VirtualizingPanel.IsVirtualizing="True"
                                                  VirtualizingPanel.ScrollUnit="Pixel">
                                            <ListView.View>
                                                <GridView>
                                                    <GridViewColumn Width="42" Header="âœ“">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <CheckBox HorizontalAlignment="Center"
                                                                          Style="{StaticResource GlobalCheckBoxStyle}"
                                                                          IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                                          IsHitTestVisible="True" />
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                    <GridViewColumn Width="180" Header="Name" DisplayMemberBinding="{Binding Name}" />
                                                    <GridViewColumn Width="120" Header="Category" DisplayMemberBinding="{Binding Category}" />
                                                    <GridViewColumn Width="220" Header="Winget ID" DisplayMemberBinding="{Binding WingetId}" />
                                                    <GridViewColumn Width="60" Header="Score" DisplayMemberBinding="{Binding TrendScore}" />
                                                    <GridViewColumn Width="120" Header="Status">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <Border CornerRadius="6" Padding="6,2" Margin="0,1">
                                                                    <Border.Style>
                                                                        <Style TargetType="Border">
                                                                            <Setter Property="Background" Value="Transparent" />
                                                                            <Setter Property="Visibility" Value="Collapsed" />
                                                                            <Style.Triggers>
                                                                                <DataTrigger Binding="{Binding CatalogStatus}" Value="âœ… Installed">
                                                                                    <Setter Property="Background" Value="#2228A745" />
                                                                                    <Setter Property="Visibility" Value="Visible" />
                                                                                </DataTrigger>
                                                                                <DataTrigger Binding="{Binding CatalogStatus}" Value="ðŸ“‹ In My Setup">
                                                                                    <Setter Property="Background" Value="#223B82F6" />
                                                                                    <Setter Property="Visibility" Value="Visible" />
                                                                                </DataTrigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Border.Style>
                                                                    <TextBlock Text="{Binding CatalogStatus}" FontSize="11" FontWeight="SemiBold">
                                                                        <TextBlock.Style>
                                                                            <Style TargetType="TextBlock">
                                                                                <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
                                                                                <Style.Triggers>
                                                                                    <DataTrigger Binding="{Binding CatalogStatus}" Value="âœ… Installed">
                                                                                        <Setter Property="Foreground" Value="#28A745" />
                                                                                    </DataTrigger>
                                                                                    <DataTrigger Binding="{Binding CatalogStatus}" Value="ðŸ“‹ In My Setup">
                                                                                        <Setter Property="Foreground" Value="#3B82F6" />
                                                                                    </DataTrigger>
                                                                                </Style.Triggers>
                                                                            </Style>
                                                                        </TextBlock.Style>
                                                                    </TextBlock>
                                                                </Border>
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                </GridView>
                                            </ListView.View>
                                        </ListView>

                                        <!-- Footer -->
                                        <Grid Grid.Row="3" Margin="0,8,0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Button Content="Select All" Style="{StaticResource GhostButtonStyle}"
                                                    Click="StoreSelectAll_Click" Margin="0,0,5,0" />
                                            <Button Grid.Column="1" Content="Select None" Style="{StaticResource GhostButtonStyle}"
                                                    Click="StoreSelectNone_Click" Margin="0,0,5,0" />
                                            <Border Grid.Column="2" HorizontalAlignment="Left" VerticalAlignment="Center"
                                                    Background="{DynamicResource SurfaceHighBrush}"
                                                    CornerRadius="8" Padding="10,4" Margin="8,0,0,0">
                                                <TextBlock Text="{Binding StoreSelectionSummary}" Foreground="{DynamicResource TextSecondaryBrush}" FontSize="11" />
                                            </Border>
                                            <Button Grid.Column="4" Content="Add to My Setup"
                                                    Click="AddStoreTrendApp_Click" />
                                        </Grid>
                                    </Grid>
                                </Border>
                            </TabItem>

                            <!-- â•â•â• TAB 3: Full Search (live winget) â•â•â• -->
                            <TabItem Header="ðŸ”  Full Search">
                                <Border Padding="12,8">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!-- Search bar -->
                                        <Grid Grid.Row="0" Margin="0,4,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBox x:Name="SearchTextBox"
                                                     Text="{Binding WingetSearchQuery, UpdateSourceTrigger=PropertyChanged}"
                                                     KeyDown="SearchTextBox_KeyDown"
                                                     VerticalContentAlignment="Center"
                                                     Tag="Search apps (e.g. 'vscode', 'pdf')..." 
                                                     Style="{StaticResource SearchBoxStyle}"/> 
                                            <Button Grid.Column="1" Content="ðŸ” Search winget"
                                                    Click="WingetSearch_Click" Margin="8,0,0,0"
                                                    IsEnabled="{Binding IsSearching, Converter={StaticResource InverseBoolConverter}}" />
                                        </Grid>

                                        <!-- Search results list -->
                                        <ListView Grid.Row="1" Margin="0,8,0,0"
                                                  ItemsSource="{Binding WingetSearchResultsView}"
                                                  SelectionMode="Single"
                                                  VirtualizingPanel.IsVirtualizing="True"
                                                  VirtualizingPanel.ScrollUnit="Pixel">
                                            <ListView.View>
                                                <GridView>
                                                    <GridViewColumn Width="42" Header="âœ“">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <CheckBox HorizontalAlignment="Center"
                                                                          Style="{StaticResource GlobalCheckBoxStyle}"
                                                                          IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                                                          IsHitTestVisible="True" />
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                    <GridViewColumn Width="220" Header="Name" DisplayMemberBinding="{Binding Name}" />
                                                    <GridViewColumn Width="280" Header="Winget ID" DisplayMemberBinding="{Binding WingetId}" />
                                                    <GridViewColumn Width="100" Header="Status">
                                                        <GridViewColumn.CellTemplate>
                                                            <DataTemplate>
                                                                <TextBlock Text="{Binding CatalogStatus}" FontSize="11">
                                                                    <TextBlock.Style>
                                                                        <Style TargetType="TextBlock">
                                                                            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
                                                                        </Style>
                                                                    </TextBlock.Style>
                                                                </TextBlock>
                                                            </DataTemplate>
                                                        </GridViewColumn.CellTemplate>
                                                    </GridViewColumn>
                                                </GridView>
                                            </ListView.View>
                                        </ListView>

                                        <!-- Footer -->
                                        <Grid Grid.Row="2" Margin="0,8,0,4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <Button Content="Select All" Style="{StaticResource GhostButtonStyle}"
                                                    Click="SearchSelectAll_Click" Margin="0,0,5,0" />
                                            <Button Grid.Column="1" Content="Select None" Style="{StaticResource GhostButtonStyle}"
                                                    Click="SearchSelectNone_Click" Margin="0,0,5,0" />
                                            <TextBlock Grid.Column="2" VerticalAlignment="Center" FontSize="11" Margin="10,0,0,0"
                                                       Text="{Binding StoreSelectionSummary}"
                                                       Foreground="{DynamicResource TextSecondaryBrush}" />
                                            <Button Grid.Column="3" Content="Add to My Setup"
                                                    Click="AddStoreTrendApp_Click" />
                                        </Grid>
                                    </Grid>
                                </Border>
                            </TabItem>
                        </TabControl>
                    </Border>
                </Grid>
            </Grid>
        </Grid>
    </Border>
</Window>
